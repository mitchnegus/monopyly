<div class="expanded">
  <div class="row">

    <div class="row-content">

      <div class="setting">
        <div class="date column">
          <div class="month">
            {{ transaction['transaction_date'].strftime('%b')|upper }}
          </div>
          <div class="day">
            {{ transaction['transaction_date'].strftime('%d')|upper }}
          </div>
          <div class="year">
            {{ transaction['transaction_date'].year }}
          </div>
          <div class="full">
            {{ transaction['transaction_date'] }}
          </div>
        </div>

        <div class="description">

          <div class="description-header">
            <div class="vendor">
              {{ transaction['vendor'] }}
            </div>
            <div class="total">
              ${{ transaction['total']|currency }}
            </div>
          </div>

          <div class="subtransaction-container">
            <!-- Populate with AJAX request -->
          </div>

        </div>
      </div>

      <div class="payment">

        {% if 'statement_id' in transaction.keys() %}
          <div class="statement">
            <a href="{{ url_for('credit.load_statement_details', statement_id=transaction['statement_id']) }}">
              <img src="{{ url_for('static', filename='img/statement.png') }}" />
              <div class="date">
                <div class="month">{{ transaction['issue_date'].strftime('%b')|upper }}</div>
                <div class="year">{{ transaction['issue_date'].year }}</div>
              </div>
            </a>
          </div>
        {% endif %}

        {% if 'account_id' in transaction.keys() %}
          <div class="card">
            <a href="{{ url_for('credit.load_account', account_id=transaction['account_id']) }}">
              {% with %}
                {% set img_base = url_for('static', filename='img/cards/') %}
                {% set card_url =  img_base + transaction['bank_name'].lower() + '-card.png' %}
                {% set template_url = img_base + 'template-card.png' %}
                <img class="card-background" src="{{ card_url }}" onerror="if (this.src != '{{ template_url }}') this.src = '{{ template_url }}'" />
                <div class="card-number">
                  {{ transaction['last_four_digits'] }}
                </div>
              {% endwith %}
            </a>
          </div>
        {% endif %}

      </div>

    </div>

    <div class="buttons column">

      <img class="less button" src="{{ url_for('static', filename='img/icons/x-thick.png') }}" />

      {% if 'statement_id' in transaction.keys() %}
        <a class="button" href="{{ url_for('credit.load_statement_details', statement_id=transaction['statement_id']) }}">
          <img class="icon" src="{{ url_for('static', filename='img/icons/statement.png') }}" />
        </a>
      {% endif %}

      {% if transaction['internal_transaction_id'] %}
        <img class="link button" data-transaction-id="{{ transaction['id'] }}" src="{{ url_for('static', filename='img/icons/link.png') }}" />
      {% endif %}

      <a class="button" href="{{ url_for('credit.update_transaction', transaction_id=transaction['id']) }}">
        <img class="edit icon" src="{{ url_for('static', filename='img/icons/edit.png') }}" />
      </a>

      <a class="action button delete" href="{{ url_for('credit.delete_transaction', transaction_id=transaction['id']) }}" onclick="return confirm('Are you sure you want to delete this transaction?');">
      </a>

    </div>

  </div>
</div>

