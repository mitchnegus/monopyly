{% extends 'layout.html' %}


{% block header %}

	<h1>
		{% block title %}
			Account Details
		{% endblock %}
	</h1>

	<nav id="sidebar-nav-menu">
		<ul>

			<li>
				<a class="action" href="{{ url_for('credit.show_cards') }}">
					<img class="button-icon" src="{{ url_for('static', filename='img/arrow-left.png') }}" />
				</a>
			</li>

			<li>
				<a class="action" href="{{ url_for('credit.new_card') }}">
					<img class="button-icon" src="{{ url_for('static', filename='img/plus.png') }}" />
				</a>
			</li>

		</ul>
	</nav>

{% endblock %}


{% block content %}

	<div id="account-details">

		<div id="account-menu">
			<a class="icon-button delete" href="{{ url_for('credit.delete_account', account_id=account['id']) }}" onclick="return confirm('Are you sure you want to delete this account?');">
			</a>
		</div>

		<div id="account-info">

			<div class="info-row">
				<div class="info-title">Bank</div>
				<div>{{ account['bank'] }}</div>
			</div>

			<div class="info-row">
				<div class="info-title">Cards</div>
				<div class="cards-container">
					{% for card in cards %}
					
						<div class="credit-card-block">
							<div class="credit-card {{'inactive' if not card['active'] else '' }}">

								<div class="card-face front">
									<img class="card-background" src="{{ url_for('static', filename='img/cards/') }}{{ card['bank'].lower() }}-card.png">
									<div class="number">
										<div class="digits obscure">▐▐▐▐</div>
										<div class="digits obscure">▐▐▐▐</div>
										<div class="digits obscure">▐▐▐▐</div>
										<div class="digits">{{ card['last_four_digits'] }}</div>
									</div>
									{% if not card['active'] %}
										<div class="notice">INACTIVE</div>
									{% endif %}
								</div>

								<div class="card-face back">
									<div class="bank">{{ card['bank']|upper }}</div>
									<div class="number">
										<div class="digits obscure">▐▐▐▐</div>
										<div class="digits obscure">▐▐▐▐</div>
										<div class="digits obscure">▐▐▐▐</div>
										<div class="digits">{{ card['last_four_digits'] }}</div>
									</div>
									<div class="options">
										<div class="slider">
											<input type="checkbox" />
										</div>
										<a class="icon-button delete" href="{{ url_for('credit.delete_card', card_id=card['id']) }}" onclick="return confirm('Are you sure you want to delete this card?');">
										</a>
									</div>
								</div>

							</div>
						</div>
					
					{% endfor %}
				</div>
			</div>

			<div class="info-row">
				<div class="info-title">Statement Issue Day</div>
				<div>
					<div id="statement-issue-day" class="update-db-widget key-day">
						<div class="widget-text">
							<div class="widget-display">
								{{- account['statement_issue_day'] -}}
							</div>
							<input class="widget-input" type="text" name="issue_day" value="{{ account['statement_issue_day'] }}" />
						</div>
						<img class="widget-edit-icon" src="{{ url_for('static', filename='img/edit.png') }}" />
					</div>
				</div>
			</div>

			<div class="info-row">
				<div class="info-title">Statement Due Day</div>
				<div>
					<div id="statement-due-day" class="update-db-widget key-day">
						<div class="widget-text">
							<div class="widget-display">
								{{- account['statement_due_day'] -}}
							</div>
							<input class="widget-input" type="text" name="due_day" value="{{ account['statement_due_day'] }}" />
						</div>
						<img class="widget-edit-icon" src="{{ url_for('static', filename='img/edit.png') }}" />
					</div>
				</div>
			</div>

		</div>

	</div>

{% endblock %}


{% block javascript %}

	<script>
		const UPDATE_ACCOUNT_STATEMENT_ISSUE_DAY_ENDPOINT = "{{ url_for('credit.update_account_statement_issue_day', account_id=account['id']) }}";
		const UPDATE_ACCOUNT_STATEMENT_DUE_DAY_ENDPOINT = "{{ url_for('credit.update_account_statement_due_day', account_id=account['id']) }}";
	</script>
	<script src="{{ url_for('static', filename='js/flip_card.js') }}">
	</script>
	<script type="module" src="{{ url_for('static', filename='js/update_account_statement_due_day.js') }}">
	</script>
	<script type="module" src="{{ url_for('static', filename='js/update_account_statement_issue_day.js') }}">
	</script>

{% endblock %}
